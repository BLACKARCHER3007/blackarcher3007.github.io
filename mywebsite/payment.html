<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Billing Dashboard | Zero & One</title>
    <link rel="icon" href="assets/images/zero-and-one-logo.jpeg" type="image/jpeg">
    <link rel="stylesheet" href="theme.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;600;700&display=swap" rel="stylesheet">
    <!-- Cashfree SDK -->
    <script src="https://sdk.cashfree.com/js/v3/cashfree.js"></script>
    <style>
        .dashboard-container { max-width: 1000px; margin: 40px auto; padding: 20px; }
        .bill-card { padding: 40px; margin-bottom: 30px; display: flex; justify-content: space-between; align-items: center; }
        .bill-info h2 { font-size: 2.5rem; margin: 10px 0; }
        .payment-options { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 20px; }
        .option-card { padding: 30px; text-align: center; cursor: pointer; transition: var(--transition); }
        .option-card:hover { transform: translateY(-5px); border-color: var(--primary); }
        .status-badge { padding: 6px 16px; border-radius: 20px; font-size: 0.8rem; font-weight: 600; }
        .status-unpaid { background: rgba(239, 68, 68, 0.1); color: #ef4444; }
        .status-paid { background: rgba(16, 185, 129, 0.1); color: #10b981; }
    </style>
</head>
<body>
    <header style="padding: 20px 40px; display: flex; justify-content: space-between; align-items: center;">
        <a href="index.html" style="text-decoration: none; display: flex; align-items: center; gap: 10px;">
            <img src="assets/images/zero-and-one-logo.jpeg" alt="Logo" style="width: 40px; border-radius: 50%;">
            <span style="font-weight: 700; font-size: 1.2rem; color: #fff;">Zero & One</span>
        </a>
        <div style="display: flex; align-items: center; gap: 20px;">
            <span id="user-name-display" style="color: #a1a1aa; font-weight: 500;"></span>
            <button id="logout-btn" class="btn-premium" style="background: rgba(255,255,255,0.05); font-size: 0.85rem; padding: 8px 16px;" onclick="Core.logout()">Logout</button>
        </div>
    </header>

    <main class="dashboard-container">
        <div class="bill-card glass-panel">
            <div class="bill-info">
                <span class="status-badge status-unpaid" id="bill-status">Payment Pending</span>
                <p style="color: #a1a1aa; margin-top: 20px;">Current Balance</p>
                <h2 id="bill-amount">₹0.00</h2>
                <p id="bill-date" style="color: #71717a; font-size: 0.9rem;">Last Updated: --</p>
            </div>
            <div>
                <button class="btn-premium" style="background: var(--primary); padding: 15px 40px;" onclick="PaymentHandler.handleCashfreePayment()">Quick Pay</button>
            </div>
        </div>

        <h3 style="margin-bottom: 20px;">Payment Methods</h3>
        <div class="payment-options">
            <div class="option-card glass-panel" id="cashfree-pay-btn" onclick="PaymentHandler.handleCashfreePayment()">
                <h4 style="margin-bottom: 10px;">Cashfree PG</h4>
                <p style="color: #71717a; font-size: 0.9rem; margin-bottom: 20px;">Card, NetBanking, Wallet & UPI</p>
                <button class="btn-premium" style="width: 100%; background: var(--primary);">Pay Now</button>
            </div>
            <div class="option-card glass-panel" onclick="PaymentHandler.openPaymentModal('upi')">
                <h4 style="margin-bottom: 10px;">Direct UPI</h4>
                <p style="color: #71717a; font-size: 0.9rem; margin-bottom: 20px;">Instant verification via any UPI app</p>
                <button class="btn-premium" style="width: 100%; background: rgba(255,255,255,0.05);">Select UPI</button>
            </div>
            <div class="option-card glass-panel" onclick="PaymentHandler.openPaymentModal('qr')">
                <h4 style="margin-bottom: 10px;">QR Code</h4>
                <p style="color: #71717a; font-size: 0.9rem; margin-bottom: 20px;">Scan and pay securely</p>
                <button class="btn-premium" style="width: 100%; background: rgba(255,255,255,0.05);">Show QR</button>
            </div>
        </div>
    </main>

    <!-- Payment Modals -->
    <div id="payment-modal" class="modal-overlay" style="display: none;">
        <div class="modal-content glass-panel">
            <span class="close-modal" onclick="PaymentHandler.closeModal()">&times;</span>
            <div id="upi-modal-content" style="display: none;">
                <h3 style="margin-bottom: 20px;">UPI Payment</h3>
                <div class="qr-container" style="text-align: center; margin-bottom: 20px;">
                    <p style="color: #a1a1aa; margin-bottom: 15px;">Pay to:</p>
                    <div class="copy-field">
                        <span id="upi-id-display">zeroandone@upi</span>
                        <button class="btn-icon" onclick="PaymentHandler.copyUPI()">
                            <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"></path></svg>
                        </button>
                    </div>
                </div>
                <button id="pay-app-btn" class="btn-premium" style="width: 100%; margin-bottom: 10px; background: var(--primary);">Open UPI App</button>
                <p style="font-size: 0.8rem; color: #71717a; text-align: center;">Tap to open generic UPI intent (Mobile only)</p>
            </div>

            <div id="qr-modal-content" style="display: none;">
                <h3 style="margin-bottom: 20px;">Scan QR Code</h3>
                <div style="text-align: center; margin-bottom: 20px; background: white; padding: 20px; border-radius: 10px;">
                    <!-- User provided QR -->
                    <img id="payment-qr-code" src="assets/images/payment/qr%20code%20kvb.jpeg" alt="Payment QR" style="width: 200px; height: 200px; object-fit: contain;">
                </div>
                <p style="text-align: center; color: #a1a1aa;">Scan with any UPI app to pay</p>
            </div>
             <div id="manual-verify-content" style="display: none; text-align: center;">
                 <h3 style="margin-bottom: 15px;">Payment Sent?</h3>
                 <p style="color: #a1a1aa; margin-bottom: 20px;">Click below to notify admin for verification.</p>
                 <button class="btn-premium" onclick="PaymentHandler.requestVerification()" style="background: var(--primary);">I Have Paid</button>
             </div>
        </div>
    </div>

    <style>
        .modal-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0, 0, 0, 0.8); backdrop-filter: blur(5px);
            display: flex; justify-content: center; align-items: center; z-index: 1000;
        }
        .modal-content {
            background: #09090b; border: 1px solid rgba(255,255,255,0.1);
            padding: 30px; border-radius: 20px; width: 90%; max-width: 400px; position: relative;
        }
        .close-modal {
            position: absolute; top: 15px; right: 20px; font-size: 24px; cursor: pointer; color: #a1a1aa;
        }
        .copy-field {
            background: rgba(255,255,255,0.05); padding: 10px 15px; border-radius: 8px;
            display: flex; justify-content: space-between; align-items: center;
            border: 1px solid rgba(255,255,255,0.1);
        }
        .btn-icon { background: none; border: none; color: var(--primary); cursor: pointer; padding: 5px; }
    </style>

    <script src="core.js"></script>
    <script src="payment-handler.js"></script>

    <script>
      if ('serviceWorker' in navigator) {
        navigator.serviceWorker.register('/service-worker.js')
          .then(reg => console.log('[SW] Registered:', reg.scope))
          .catch(err => console.warn('[SW] Failed:', err));
      }
    </script>
</body>
</html>
